<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cronómetro Avanzado</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em;}
    .chrono { font-size:2em; margin:1em 0;}
    .laps { margin-top:1em;}
    button { margin:0.5em;}
  </style>
</head>
<body>
  <h1>Cronómetro Avanzado</h1>
  <div class="chrono" id="tiempo">00:00:00.00</div>
  <button onclick="iniciar()">Iniciar</button>
  <button onclick="parar()">Parar</button>
  <button onclick="reiniciar()">Reiniciar</button>
  <button onclick="lap()">Lap</button>
  <div class="laps" id="laps"></div>
  <script>
    let start = 0, running = false, interval, laps = [];
    function format(ms) {
      let t = new Date(ms);
      let min = t.getUTCMinutes().toString().padStart(2,'0');
      let sec = t.getUTCSeconds().toString().padStart(2,'0');
      let mil = Math.floor((ms%1000)/10).toString().padStart(2,'0');
      return `${min}:${sec}.${mil}`;
    }
    function tick() {
      document.getElementById('tiempo').textContent = format(Date.now()-start);
    }
    function iniciar() {
      if(!running) {
        start = Date.now()-(parseInt(document.getElementById('tiempo').dataset.ms||'0'));
        interval = setInterval(tick, 25);
        running = true;
      }
    }
    function parar() {
      if(running) {
        let ms = Date.now()-start;
        document.getElementById('tiempo').dataset.ms = ms;
        clearInterval(interval);
        running = false;
      }
    }
    function reiniciar() {
      start = Date.now();
      document.getElementById('tiempo').textContent = '00:00:00.00';
      document.getElementById('tiempo').dataset.ms = 0;
      laps = [];
      document.getElementById('laps').innerHTML = '';
      if(running) clearInterval(interval); running = false;
    }
    function lap() {
      let ms = running ? Date.now()-start : parseInt(document.getElementById('tiempo').dataset.ms||'0');
      laps.push(ms);
      document.getElementById('laps').innerHTML += `<div>Lap ${laps.length}: ${format(ms)}</div>`;
    }
  </script>
</body>
</html>
